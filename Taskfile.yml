version: '3'

vars:
  AWS_INSTANCE_ID: "i-022f3394d98803da8"
  SSH_KEY: "cactus-key.pem"
  COMPOSE_FILE: "docker-compose.prod.yml"

tasks:
  # ===== DESARROLLO LOCAL =====
  dev:
    desc: "ğŸš€ Iniciar desarrollo local completo"
    cmds:
      - task: cleanup
      - echo "ğŸŒµ Iniciando CactusDashboard en modo desarrollo..."
      - docker-compose -f {{.COMPOSE_FILE}} up -d
      - echo "â³ Esperando que los servicios estÃ©n listos..."
      - sleep 10
      - task: status:local
      - echo "ğŸ‰ Desarrollo iniciado! Frontend http://localhost:3000"

  dev:frontend:
    desc: "ğŸš€ Iniciar solo frontend en localhost:3000"
    cmds:
      - echo "ğŸŒµ Iniciando frontend en localhost:3000..."
      - ./scripts/start-frontend.sh

  dev:frontend:clean:
    desc: "ğŸ§¹ Iniciar frontend con limpieza completa"
    cmds:
      - echo "ğŸ§¹ Limpiando e iniciando frontend..."
      - ./scripts/cleanup-ports.sh 3000
      - cd cactus-wealth-frontend && rm -rf .next node_modules/.cache
      - cd cactus-wealth-frontend && npm install
      - ./scripts/start-frontend.sh

  dev:stop:
    desc: "â¹ï¸ Detener desarrollo local"
    cmds:
      - echo "ğŸ›‘ Deteniendo servicios locales..."
      - docker-compose -f {{.COMPOSE_FILE}} down
      - task: cleanup
      - echo "âœ… Servicios locales detenidos"

  dev:restart:
    desc: "ğŸ”„ Reiniciar desarrollo local"
    cmds:
      - task: dev:stop
      - task: dev

  dev:rebuild:
    desc: "ğŸ”¨ Rebuild completo y reiniciar"
    cmds:
      - echo "ğŸ”¨ Rebuilding servicios..."
      - docker-compose -f {{.COMPOSE_FILE}} down
      - docker-compose -f {{.COMPOSE_FILE}} build --no-cache
      - docker-compose -f {{.COMPOSE_FILE}} up -d
      - echo "âœ… Rebuild completado"

  # ===== LOGS Y DEBUGGING =====
  logs:
    desc: "ğŸ“º Ver logs en vivo - todos los servicios"
    cmds:
      - echo "ğŸ“º Logs en vivo (Ctrl+C para salir)..."
      - docker-compose -f {{.COMPOSE_FILE}} logs -f --tail=50

  logs:backend:
    desc: "ğŸ“º Ver logs del backend"
    cmds:
      - echo "ğŸ“º Logs del backend (Ctrl+C para salir)..."
      - docker-compose -f {{.COMPOSE_FILE}} logs -f --tail=50 backend

  logs:frontend:
    desc: "ğŸ“º Ver logs del frontend"
    cmds:
      - echo "ğŸ“º Logs del frontend (Ctrl+C para salir)..."
      - docker-compose -f {{.COMPOSE_FILE}} logs -f --tail=50 frontend

  debug:
    desc: "ğŸ” DiagnÃ³stico completo del sistema"
    cmds:
      - echo "ğŸ” DiagnÃ³stico completo de CactusDashboard..."
      - task: status:local
      - task: health:local
      - task: ports
      - task: resources

  shell:backend:
    desc: "ğŸš Shell interactivo en backend"
    cmds:
      - echo "ğŸš Entrando al contenedor backend (exit para salir)..."
      - docker-compose -f {{.COMPOSE_FILE}} exec backend /bin/bash

  shell:frontend:
    desc: "ğŸš Shell interactivo en frontend"
    cmds:
      - echo "ğŸš Entrando al contenedor frontend (exit para salir)..."
      - docker-compose -f {{.COMPOSE_FILE}} exec frontend /bin/sh

  shell:db:
    desc: "ğŸš Shell PostgreSQL"
    cmds:
      - echo "ğŸš Entrando a PostgreSQL (\\q para salir)..."
      - docker-compose -f {{.COMPOSE_FILE}} exec db psql -U cactus_user -d cactus_db

  # ===== ESTADO Y SALUD =====
  status:
    desc: "ğŸ“Š Estado general del sistema"
    cmds:
      - task: status:local

  status:local:
    desc: "ğŸ“Š Estado de servicios locales"
    cmds:
      - echo "ğŸ“Š Estado de contenedores Docker:"
      - docker-compose -f {{.COMPOSE_FILE}} ps
      - echo ""
      - echo "ğŸŒ Puertos en uso:"
      - |
        lsof -i :3000 || echo "  Puerto 3000 Libre"
        lsof -i :8000 || echo "  Puerto 8000 Libre"
        lsof -i :5432 || echo "  Puerto 5432 Libre"
        lsof -i :6379 || echo "  Puerto 6379 Libre"

  health:
    desc: "ğŸ¥ Verificar salud de servicios"
    cmds:
      - task: health:local

  health:local:
    desc: "ğŸ¥ Verificar salud de servicios locales"
    cmds:
      - echo "ğŸ¥ Verificando salud de servicios..."
      - |
        if curl -s -I http://localhost:3000 | head -1 | grep -q "200\|30[0-9]"; then
          echo "âœ… Frontend (localhost:3000): OK"
        else
          echo "âŒ Frontend (localhost:3000): No responde"
        fi
      - |
        if curl -s http://localhost:8000/health > /dev/null 2>&1; then
          echo "âœ… Backend (localhost:8000): OK"
        else
          echo "âŒ Backend (localhost:8000): No responde"
        fi

  ports:
    desc: "ğŸ”Œ Verificar puertos en uso"
    cmds:
      - echo "ğŸ”Œ Verificando puertos..."
      - |
        for port in 3000 8000 5432 6379 80 443; do
          if lsof -i :$port > /dev/null 2>&1; then
            echo "âœ… Puerto $port en uso"
          else
            echo "âšª Puerto $port libre"
          fi
        done

  resources:
    desc: "ğŸ“ˆ Mostrar uso de recursos"
    cmds:
      - echo "ğŸ“ˆ Uso de recursos del sistema..."
      - echo "ğŸ³ EstadÃ­sticas de contenedores:"
      - docker stats --no-stream --format "table {{.Name}}\t{{.CPUPerc}}\t{{.MemUsage}}"
      - echo ""
      - echo "ğŸ’» Sistema:"
      - |
        top -l 1 | grep "CPU usage" || echo "  CPU: No disponible"
      - echo "ğŸ’¾ Disco:"
      - |
        df -h . | tail -1

  # ===== LIMPIEZA Y MANTENIMIENTO =====
  cleanup:
    desc: "ğŸ§¹ Limpiar puertos y cachÃ©s"
    cmds:
      - echo "ğŸ§¹ Limpiando puertos y cachÃ©s..."
      - ./scripts/cleanup-ports.sh
      - |
        if [ -d "cactus-wealth-frontend/node_modules/.cache" ]; then
          rm -rf cactus-wealth-frontend/node_modules/.cache
          echo "ğŸ—‘ï¸ CachÃ© de Node.js limpiado"
        fi
        if [ -d "cactus-wealth-frontend/.next" ]; then
          rm -rf cactus-wealth-frontend/.next
          echo "ğŸ—‘ï¸ Build de Next.js limpiado"
        fi
      - echo "âœ… Limpieza completada"

  cleanup:ports:
    desc: "ğŸ§¹ Limpiar solo puertos (3000, 3001, 8000, 8080)"
    cmds:
      - echo "ğŸ§¹ Limpiando puertos..."
      - ./scripts/cleanup-ports.sh
      - echo "âœ… Puertos limpiados"

  cleanup:frontend:
    desc: "ğŸ§¹ Limpiar cachÃ© y build del frontend"
    cmds:
      - echo "ğŸ§¹ Limpiando frontend..."
      - |
        cd cactus-wealth-frontend
        rm -rf .next node_modules/.cache dist build
        echo "ğŸ—‘ï¸ Archivos de build y cachÃ© eliminados"
      - echo "âœ… Frontend limpiado"

  # ===== AWS GESTIÃ“N =====
  aws:start:
    desc: "â–¶ï¸ Iniciar instancia EC2"
    cmds:
      - echo "â–¶ï¸ Iniciando instancia EC2..."
      - |
        current_state=$(aws ec2 describe-instances --instance-ids {{.AWS_INSTANCE_ID}} --query 'Reservations[0].Instances[0].State.Name' --output text 2>/dev/null || echo "unknown")
        if [ "$current_state" = "running" ]; then
          echo "âš ï¸ La instancia ya estÃ¡ ejecutÃ¡ndose"
          ip=$(aws ec2 describe-instances --instance-ids {{.AWS_INSTANCE_ID}} --query 'Reservations[0].Instances[0].PublicIpAddress' --output text)
          echo "ğŸŒ IP pÃºblica: $ip"
          echo "ğŸ”— URL: http://$ip"
        else
          aws ec2 start-instances --instance-ids {{.AWS_INSTANCE_ID}} > /dev/null
          echo "â³ Esperando que la instancia estÃ© lista..."
          aws ec2 wait instance-running --instance-ids {{.AWS_INSTANCE_ID}}
          ip=$(aws ec2 describe-instances --instance-ids {{.AWS_INSTANCE_ID}} --query 'Reservations[0].Instances[0].PublicIpAddress' --output text)
          echo "âœ… Instancia iniciada exitosamente"
          echo "ğŸŒ IP pÃºblica: $ip"
          echo "ğŸ”— URL: http://$ip"
        fi

  aws:stop:
    desc: "â¹ï¸ Detener instancia EC2 (ahorrar dinero)"
    cmds:
      - echo "â¹ï¸ Deteniendo instancia EC2..."
      - |
        current_state=$(aws ec2 describe-instances --instance-ids {{.AWS_INSTANCE_ID}} --query 'Reservations[0].Instances[0].State.Name' --output text 2>/dev/null || echo "unknown")
        if [ "$current_state" = "stopped" ]; then
          echo "âš ï¸ La instancia ya estÃ¡ detenida"
        else
          aws ec2 stop-instances --instance-ids {{.AWS_INSTANCE_ID}} > /dev/null
          echo "â³ Esperando que la instancia se detenga..."
          aws ec2 wait instance-stopped --instance-ids {{.AWS_INSTANCE_ID}}
          echo "âœ… Instancia detenida exitosamente"
          echo "ğŸ’° Â¡Dinero ahorrado! La instancia ya no genera costos"
        fi

  aws:status:
    desc: "ğŸ“Š Estado de la instancia EC2"
    cmds:
      - echo "ğŸ“Š Verificando estado de la instancia EC2..."
      - |
        state=$(aws ec2 describe-instances --instance-ids {{.AWS_INSTANCE_ID}} --query 'Reservations[0].Instances[0].State.Name' --output text 2>/dev/null || echo "unknown")
        type=$(aws ec2 describe-instances --instance-ids {{.AWS_INSTANCE_ID}} --query 'Reservations[0].Instances[0].InstanceType' --output text 2>/dev/null || echo "unknown")
        ip=$(aws ec2 describe-instances --instance-ids {{.AWS_INSTANCE_ID}} --query 'Reservations[0].Instances[0].PublicIpAddress' --output text 2>/dev/null || echo "none")
        
        echo "ğŸ†” ID: {{.AWS_INSTANCE_ID}}"
        echo "ğŸ“¦ Tipo: $type"
        echo "ğŸ”„ Estado: $state"
        if [ "$ip" != "none" ] && [ "$ip" != "null" ]; then
          echo "ğŸŒ IP pÃºblica: $ip"
          echo "ğŸ”— URL: http://$ip"
        else
          echo "ğŸŒ IP pÃºblica: No asignada"
        fi

  aws:ip:
    desc: "ğŸŒ Obtener IP pÃºblica de la instancia"
    cmds:
      - |
        ip=$(aws ec2 describe-instances --instance-ids {{.AWS_INSTANCE_ID}} --query 'Reservations[0].Instances[0].PublicIpAddress' --output text 2>/dev/null || echo "none")
        if [ "$ip" != "none" ] && [ "$ip" != "null" ]; then
          echo "ğŸŒ IP pÃºblica: $ip"
          echo "ğŸ”— URL: http://$ip"
        else
          echo "âŒ No hay IP pÃºblica asignada (instancia detenida?)"
        fi

  aws:costs:
    desc: "ğŸ’° Ver informaciÃ³n de costos"
    cmds:
      - echo "ğŸ’° InformaciÃ³n de costos AWS..."
      - |
        type=$(aws ec2 describe-instances --instance-ids {{.AWS_INSTANCE_ID}} --query 'Reservations[0].Instances[0].InstanceType' --output text 2>/dev/null || echo "unknown")
        state=$(aws ec2 describe-instances --instance-ids {{.AWS_INSTANCE_ID}} --query 'Reservations[0].Instances[0].State.Name' --output text 2>/dev/null || echo "unknown")
        
        echo "ğŸ“¦ Tipo de instancia: $type"
        echo "ğŸ”„ Estado actual: $state"
        echo ""
        echo "ğŸ’¡ Costos estimados por hora (regiÃ³n us-east-1):"
        case $type in
          "t2.micro") echo "   ğŸ’µ \$0.0116/hora (~\$8.50/mes)" ;;
          "t2.small") echo "   ğŸ’µ \$0.023/hora (~\$17/mes)" ;;
          "t2.medium") echo "   ğŸ’µ \$0.046/hora (~\$34/mes)" ;;
          "t3.micro") echo "   ğŸ’µ \$0.0104/hora (~\$7.60/mes)" ;;
          "t3.small") echo "   ğŸ’µ \$0.0208/hora (~\$15/mes)" ;;
          *) echo "   ğŸ’µ Consulta AWS Pricing para $type" ;;
        esac
        echo ""
        if [ "$state" = "running" ]; then
          echo "âš ï¸ La instancia estÃ¡ EJECUTÃNDOSE - generando costos"
          echo "ğŸ’¡ Usa 'task aws:stop' para detenerla y ahorrar dinero"
        else
          echo "âœ… La instancia estÃ¡ DETENIDA - sin costos de cÃ³mputo"
          echo "ğŸ’¡ Usa 'task aws:start' para iniciarla cuando la necesites"
        fi

  aws:ssh:
    desc: "ğŸ” Conectar SSH a la instancia"
    cmds:
      - |
        ip=$(aws ec2 describe-instances --instance-ids {{.AWS_INSTANCE_ID}} --query 'Reservations[0].Instances[0].PublicIpAddress' --output text 2>/dev/null || echo "none")
        if [ "$ip" != "none" ] && [ "$ip" != "null" ]; then
          echo "ğŸ” Conectando SSH a $ip..."
          ssh -i {{.SSH_KEY}} ubuntu@$ip
        else
          echo "âŒ No se puede conectar: instancia sin IP pÃºblica"
          echo "ğŸ’¡ Usa 'task aws:start' primero"
        fi

  aws:health:
    desc: "ğŸ¥ Verificar salud de servicios en AWS"
    cmds:
      - |
        ip=$(aws ec2 describe-instances --instance-ids {{.AWS_INSTANCE_ID}} --query 'Reservations[0].Instances[0].PublicIpAddress' --output text 2>/dev/null || echo "none")
        if [ "$ip" != "none" ] && [ "$ip" != "null" ]; then
          echo "ğŸ¥ Verificando salud de servicios en $ip..."
          if curl -s -I http://$ip | head -1 | grep -q "200\|30[0-9]"; then
            echo "âœ… AplicaciÃ³n web: OK"
          else
            echo "âŒ AplicaciÃ³n web: No responde"
          fi
          if curl -s http://$ip/api/health > /dev/null 2>&1; then
            echo "âœ… API Backend: OK"
          else
            echo "âŒ API Backend: No responde"
          fi
        else
          echo "âŒ No se puede verificar: instancia sin IP pÃºblica"
        fi

  # ===== DESPLIEGUE =====
  deploy:aws:
    desc: "ğŸš€ Desplegar a AWS"
    cmds:
      - echo "ğŸš€ Desplegando CactusDashboard a AWS..."
      - task: aws:start
      - |
        ip=$(aws ec2 describe-instances --instance-ids {{.AWS_INSTANCE_ID}} --query 'Reservations[0].Instances[0].PublicIpAddress' --output text)
        echo "ğŸ“¦ Desplegando aplicaciÃ³n en $ip..."
        
        if ssh -i {{.SSH_KEY}} -o ConnectTimeout=10 ubuntu@$ip "echo 'ConexiÃ³n SSH exitosa'" > /dev/null 2>&1; then
          echo "âœ… ConexiÃ³n SSH establecida"
          
          ssh -i {{.SSH_KEY}} ubuntu@$ip "cd /home/ubuntu/CactusDashboard && docker-compose -f docker-compose.prod.yml down"
          ssh -i {{.SSH_KEY}} ubuntu@$ip "cd /home/ubuntu/CactusDashboard && git pull origin main"
          ssh -i {{.SSH_KEY}} ubuntu@$ip "cd /home/ubuntu/CactusDashboard && docker-compose -f docker-compose.prod.yml build"
          ssh -i {{.SSH_KEY}} ubuntu@$ip "cd /home/ubuntu/CactusDashboard && docker-compose -f docker-compose.prod.yml up -d"
          
          echo "â³ Esperando que los servicios estÃ©n listos..."
          sleep 30
          
          if curl -s -I http://$ip | head -1 | grep -q "200\|30[0-9]"; then
            echo "âœ… Despliegue exitoso!"
            echo "ğŸŒ AplicaciÃ³n disponible en: http://$ip"
          else
            echo "âŒ Error en el despliegue - la aplicaciÃ³n no responde"
          fi
        else
          echo "âŒ Error: No se puede conectar SSH a la instancia"
        fi

  # ===== CONFIGURACIÃ“N Y VALIDACIÃ“N =====
  setup:
    desc: "âš™ï¸ ConfiguraciÃ³n inicial del proyecto"
    cmds:
      - echo "âš™ï¸ Configurando CactusDashboard..."
      - echo "ğŸ“‹ Verificando dependencias..."
      - |
        docker --version || echo "âŒ Docker no instalado"
        docker-compose --version || echo "âŒ Docker Compose no instalado"
        aws --version || echo "âŒ AWS CLI no instalado"
      - echo "ğŸ“ Verificando archivos de configuraciÃ³n..."
      - |
        test -f docker-compose.prod.yml && echo "âœ… docker-compose.prod.yml" || echo "âŒ docker-compose.prod.yml no encontrado"
        test -f {{.SSH_KEY}} && echo "âœ… SSH key encontrada" || echo "âŒ SSH key {{.SSH_KEY}} no encontrada"
      - echo "âœ… ConfiguraciÃ³n inicial completada"

  validate:
    desc: "âœ… Validar configuraciÃ³n del proyecto"
    cmds:
      - echo "âœ… Validando configuraciÃ³n de CactusDashboard..."
      - task: setup
      - echo "ğŸ” Validando configuraciÃ³n AWS..."
      - |
        aws sts get-caller-identity > /dev/null && echo "âœ… AWS CLI configurado" || echo "âŒ AWS CLI no configurado"
      - echo "ğŸ” Validando instancia EC2..."
      - task: aws:status
      - echo "âœ… ValidaciÃ³n completada"

  oauth:verify:
    desc: "ğŸ” Verificar configuraciÃ³n OAuth"
    cmds:
      - echo "ğŸ” Verificando configuraciÃ³n OAuth..."
      - |
        if [ -f "cactus-wealth-frontend/.env.local" ]; then
          echo "ğŸ“ Archivo .env.local encontrado"
          
          nextauth_url=$(grep "NEXTAUTH_URL=" cactus-wealth-frontend/.env.local | cut -d'=' -f2 | tr -d '"' || echo "")
          google_client_id=$(grep "GOOGLE_CLIENT_ID=" cactus-wealth-frontend/.env.local | cut -d'=' -f2 | tr -d '"' || echo "")
          
          if [ ! -z "$nextauth_url" ]; then
            echo "âœ… NEXTAUTH_URL: $nextauth_url"
            echo ""
            echo "ğŸ”§ ConfiguraciÃ³n requerida en Google Console:"
            echo "   ğŸ“ Authorized JavaScript origins:"
            echo "      $nextauth_url"
            echo "   ğŸ“ Authorized redirect URIs:"
            echo "      $nextauth_url/api/auth/callback/google"
            echo ""
          else
            echo "âŒ NEXTAUTH_URL no encontrado en .env.local"
          fi
          
          if [ ! -z "$google_client_id" ]; then
            echo "âœ… GOOGLE_CLIENT_ID configurado"
          else
            echo "âŒ GOOGLE_CLIENT_ID no encontrado en .env.local"
          fi
          
          echo "ğŸ”— Google Console: https://console.developers.google.com/apis/credentials"
        else
          echo "âŒ Archivo .env.local no encontrado en cactus-wealth-frontend/"
          echo "ğŸ’¡ Crea el archivo basÃ¡ndote en .env.example"
        fi

  oauth:update:
    desc: "ğŸ”„ Actualizar credenciales OAuth de Google"
    cmds:
      - |
        echo "ğŸ”„ Actualizando credenciales OAuth..."
        echo ""
        echo "ğŸ“‹ Uso: task oauth:update CLIENT_ID=tu_client_id CLIENT_SECRET=tu_client_secret"
        echo ""
        echo "ğŸ“ Ejemplo:"
        echo "   task oauth:update CLIENT_ID=123456789-abcdef.apps.googleusercontent.com CLIENT_SECRET=GOCSPX-abcdef123456"
        echo ""
        echo "ğŸ”— Para obtener credenciales:"
        echo "   1. Ve a: https://console.cloud.google.com/apis/credentials"
        echo "   2. Crea OAuth 2.0 Client ID (Web application)"
        echo "   3. Configura URLs autorizadas:"
        echo "      - JavaScript origins: http://localhost:3000"
        echo "      - Redirect URIs: http://localhost:3000/api/auth/callback/google"
        echo ""
        
        if [ -z "{{.CLIENT_ID}}" ] || [ -z "{{.CLIENT_SECRET}}" ]; then
          echo "âŒ Error: Debes proporcionar CLIENT_ID y CLIENT_SECRET"
          echo ""
          echo "ğŸ’¡ Ejemplo de uso correcto:"
          echo "   task oauth:update CLIENT_ID=tu_client_id CLIENT_SECRET=tu_client_secret"
          exit 1
        fi
        
        echo "ğŸ”§ Ejecutando script de actualizaciÃ³n..."
        ./update-oauth-credentials.sh "{{.CLIENT_ID}}" "{{.CLIENT_SECRET}}"
        echo ""
        echo "âœ… Â¡Credenciales OAuth actualizadas!"
        echo "ğŸŒ Prueba la autenticaciÃ³n en: http://localhost:3000"

  # ===== AYUDA =====
  help:
    desc: "â“ Mostrar ayuda completa y organizada"
    cmds:
      - |
        clear
        echo ""
        echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
        echo "â•‘                    ğŸŒµ CACTUS DASHBOARD - TASK SYSTEM                        â•‘"
        echo "â•‘                         Sistema Unificado de Comandos                       â•‘"
        echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
        echo ""
        echo "â”Œâ”€ ğŸš€ DESARROLLO LOCAL â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”"
        echo "â”‚                                                                               â”‚"
        echo "â”‚  task dev             ğŸš€ Iniciar desarrollo completo                         â”‚"
        echo "â”‚  task dev:stop        â¹ï¸  Detener todos los servicios                        â”‚"
        echo "â”‚  task dev:restart     ğŸ”„ Reiniciar desarrollo                                â”‚"
        echo "â”‚  task dev:rebuild     ğŸ”¨ Rebuild completo y reiniciar                        â”‚"
        echo "â”‚                                                                               â”‚"
        echo "â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜"
        echo ""
        echo "â”Œâ”€ ğŸ“º LOGS & DEBUGGING â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”"
        echo "â”‚                                                                               â”‚"
        echo "â”‚  task logs            ğŸ“º Ver logs en vivo (todos los servicios)              â”‚"
        echo "â”‚  task logs:backend    ğŸ Solo logs del backend                               â”‚"
        echo "â”‚  task logs:frontend   âš›ï¸  Solo logs del frontend                             â”‚"
        echo "â”‚  task debug           ğŸ” DiagnÃ³stico completo del sistema                    â”‚"
        echo "â”‚  task shell:backend   ğŸš Shell interactivo en backend                        â”‚"
        echo "â”‚  task shell:frontend  ğŸš Shell interactivo en frontend                       â”‚"
        echo "â”‚  task shell:db        ğŸ—„ï¸  Shell PostgreSQL                                   â”‚"
        echo "â”‚                                                                               â”‚"
        echo "â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜"
        echo ""
        echo "â”Œâ”€ ğŸ“Š MONITOREO & ESTADO â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”"
        echo "â”‚                                                                               â”‚"
        echo "â”‚  task status          ğŸ“Š Estado general del sistema                          â”‚"
        echo "â”‚  task health          ğŸ¥ Verificar salud de todos los servicios              â”‚"
        echo "â”‚  task ports           ğŸ”Œ Verificar puertos en uso                            â”‚"
        echo "â”‚  task resources       ğŸ“ˆ Mostrar uso de CPU, memoria y disco                 â”‚"
        echo "â”‚                                                                               â”‚"
        echo "â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜"
        echo ""
        echo "â”Œâ”€ â˜ï¸ AWS MANAGEMENT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”"
        echo "â”‚                                                                               â”‚"
        echo "â”‚  task aws:start       â–¶ï¸  Iniciar instancia EC2                              â”‚"
        echo "â”‚  task aws:stop        â¹ï¸  Detener instancia (ğŸ’° ahorrar dinero)              â”‚"
        echo "â”‚  task aws:status      ğŸ“Š Estado de la instancia EC2                          â”‚"
        echo "â”‚  task aws:ip          ğŸŒ Obtener IP pÃºblica actual                           â”‚"
        echo "â”‚  task aws:costs       ğŸ’° Ver informaciÃ³n de costos                           â”‚"
        echo "â”‚  task aws:ssh         ğŸ” Conectar SSH a la instancia                         â”‚"
        echo "â”‚  task aws:health      ğŸ¥ Verificar salud de servicios en AWS                 â”‚"
        echo "â”‚                                                                               â”‚"
        echo "â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜"
        echo ""
        echo "â”Œâ”€ ğŸš€ DEPLOYMENT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”"
        echo "â”‚                                                                               â”‚"
        echo "â”‚  task deploy:aws      ğŸš€ Desplegar aplicaciÃ³n completa a AWS                 â”‚"
        echo "â”‚                                                                               â”‚"
        echo "â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜"
        echo ""
        echo "â”Œâ”€ âš™ï¸ CONFIGURACIÃ“N & UTILIDADES â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”"
        echo "â”‚                                                                               â”‚"
        echo "â”‚  task setup           âš™ï¸  ConfiguraciÃ³n inicial del proyecto                 â”‚"
        echo "â”‚  task validate        âœ… Validar toda la configuraciÃ³n                       â”‚"
        echo "â”‚  task oauth:verify    ğŸ” Verificar configuraciÃ³n OAuth                       â”‚"
        echo "â”‚  task oauth:update    ğŸ”„ Actualizar credenciales OAuth                       â”‚"
        echo "â”‚  task cleanup         ğŸ§¹ Limpiar puertos y cachÃ©s                            â”‚"
        echo "â”‚                                                                               â”‚"
        echo "â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜"
        echo ""
        echo "â”Œâ”€ â“ AYUDA & INFORMACIÃ“N â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”"
        echo "â”‚                                                                               â”‚"
        echo "â”‚  task help            â“ Esta ayuda completa                                  â”‚"
        echo "â”‚  task help:quick      âš¡ Ayuda rÃ¡pida (comandos esenciales)                  â”‚"
        echo "â”‚  task --list          ğŸ“‹ Lista rÃ¡pida de todos los comandos                  â”‚"
        echo "â”‚                                                                               â”‚"
        echo "â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜"
        echo ""
        echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
        echo "â•‘                           ğŸ’¡ EJEMPLOS DE USO                                â•‘"
        echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
        echo ""
        echo "  ğŸ¯ Desarrollo diario:"
        echo "     task dev                    # Iniciar desarrollo completo"
        echo "     task logs                   # Monitorear logs en tiempo real"
        echo "     task status                 # Ver estado del sistema"
        echo ""
        echo "  â˜ï¸ GestiÃ³n AWS:"
        echo "     task aws:start              # Iniciar instancia y obtener IP"
        echo "     task deploy:aws             # Desplegar aplicaciÃ³n completa"
        echo "     task aws:stop               # Detener instancia para ahorrar dinero"
        echo ""
        echo "  ğŸ”§ Troubleshooting:"
        echo "     task debug                  # DiagnÃ³stico completo"
        echo "     task cleanup                # Limpiar puertos bloqueados"
        echo "     task validate               # Verificar configuraciÃ³n"
        echo ""
        echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
        echo "â•‘                          ğŸ‰ SISTEMA UNIFICADO                               â•‘"
        echo "â•‘                                                                              â•‘"
        echo "â•‘  âœ… Todos los scripts han sido consolidados en Task                         â•‘"
        echo "â•‘  âœ… Sintaxis consistente: task <comando>                                    â•‘"
        echo "â•‘  âœ… DocumentaciÃ³n integrada y autocompletado                                â•‘"
        echo "â•‘  âœ… OptimizaciÃ³n del 90%+ en tiempos de ejecuciÃ³n                          â•‘"
        echo "â•‘                                                                              â•‘"
        echo "â•‘  ğŸ“š DocumentaciÃ³n completa: DOCUMENTATION.md                                â•‘"
        echo "â•‘  ğŸš€ GuÃ­a de inicio rÃ¡pido: README.md                                        â•‘"
        echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
        echo ""

  help:quick:
    desc: "âš¡ Ayuda rÃ¡pida - comandos esenciales"
    cmds:
      - |
        echo ""
        echo "âš¡ COMANDOS ESENCIALES - CACTUS DASHBOARD"
        echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
        echo ""
        echo "ğŸš€ DESARROLLO:"
        echo "   task dev              # Iniciar desarrollo"
        echo "   task dev:stop         # Detener desarrollo"
        echo "   task logs             # Ver logs en vivo"
        echo "   task status           # Estado del sistema"
        echo ""
        echo "â˜ï¸ AWS:"
        echo "   task aws:start        # Iniciar instancia EC2"
        echo "   task aws:stop         # Detener instancia (ahorrar dinero)"
        echo "   task deploy:aws       # Desplegar a AWS"
        echo ""
        echo "ğŸ”§ UTILIDADES:"
        echo "   task debug            # DiagnÃ³stico completo"
        echo "   task cleanup          # Limpiar puertos"
        echo "   task help             # Ayuda completa"
        echo ""
        echo "ğŸ’¡ Usa 'task help' para ver todos los comandos disponibles"
        echo ""